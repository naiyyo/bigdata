Using Mall_Customers.csv :

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
import seaborn as sns


dataset = pd.read_csv('//content/Mall_Customers.csv')
print(dataset.head())


dataset = dataset.iloc[:, [3, 4]] 
print(dataset.head())


scaler = StandardScaler()
dataset_scaled = scaler.fit_transform(dataset)


wcss = []
for i in range(1, 11):
    kmeans = KMeans(n_clusters=i, init='k-means++', max_iter=300, n_init=10, random_state=0)
    kmeans.fit(dataset_scaled)
    wcss.append(kmeans.inertia_)

plt.plot(range(1, 11), wcss)
plt.title('The Elbow Method')
plt.xlabel('Number of clusters')
plt.ylabel('WCSS')
plt.show()


kmeans = KMeans(n_clusters=5, init='k-means++', max_iter=300, n_init=10, random_state=0)

y_kmeans = kmeans.fit_predict(dataset_scaled)


dataset['Cluster'] = y_kmeans


plt.figure(figsize=(10, 7))
sns.scatterplot(x=dataset.iloc[:, 0], y=dataset.iloc[:, 1], hue=dataset['Cluster'], palette='viridis', s=100, alpha=0.7)
centers = kmeans.cluster_centers_
centers = scaler.inverse_transform(centers)
plt.scatter(centers[:, 0], centers[:, 1], c='red', s=300, alpha=0.75, marker='X') 
plt.title('Clusters of customers')
plt.xlabel('Annual Income')
plt.ylabel('Spending Score')
plt.legend(title='Cluster')
plt.show()